!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("pixi.js"),require("qunity")):"function"==typeof define&&define.amd?define(["exports","pixi.js","qunity"],e):e((t=t||self)["qunity-pixi"]={},t.PIXI,t.qunity)}(this,function(n,a,s){"use strict";a=a&&a.hasOwnProperty("default")?a.default:a;var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function t(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}function e(t,e,i,r){var o,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var s=t.length-1;0<=s;s--)(o=t[s])&&(a=(n<3?o(a):3<n?o(e,i,a):o(e,i))||a);return 3<n&&a&&Object.defineProperty(e,i,a),a}function p(t,e){var i=e(t);if(!i&&t.children&&0<t.children.length)for(var r=0,o=t.children;r<o.length;r++){if(p(o[r],e))break}return i}function d(t,e){for(var i=e(t);!i&&t.parent;)(t=t.parent)&&(i=e(t));return i}var o,h={pointertap:"click",pointerdown:"mouseDown",pointermove:"mouseMove",pointerup:"mouseUp",pointerupoutside:"mouseUpOutside"},l=(t(i,o=s.EntityAdaptorBase),i.prototype.getActive=function(){return o.prototype.getActive.call(this)&&this._entity.visible},i.prototype.setActive=function(t){o.prototype.setActive.call(this,t),this._entity.visible=t},i.prototype.applyProxy=function(){o.prototype.applyProxy.call(this);var t=this._entity;Object.defineProperty(t,"stageSize",{get:function(){var t=this.entityAdaptor.app.context.pixiApp.renderer;return{width:t.width,height:t.height}}})},i.prototype._onInteractionEvent=function(t){if(t.target||"pointerupoutside"===t.type){var e=h[t.type];this.invokeInteractionEvent(e,t)}},i);function i(t,e){var i=o.call(this,t,e)||this;for(var r in t.interactive=!0,t.visible=!1,h)t.on(r,i._onInteractionEvent,i);return i}var u=(c.pre=function(t,e){e()},c.use=function(t,e){t.extension,e()},c);function c(){}a.Loader.registerPlugin(u);var f,y,v=[];function g(o,n){var t;(t=0<v.length?v.pop():new a.Loader).add(o),t.load(function(t,e){var i=e[Object.keys(e)[0]],r=i.textures||i.texture||i.data;setTimeout(function(){n&&n(r,o)}),t.reset(),v.push(t)})}(y||(y={})).TEXTURE="texture://";var b=((f={})[y.TEXTURE]=function(t,e,i){var r=i.replace(y.TEXTURE,"");return t.getAsset(r)},f);var R,T=PIXI.Graphics,_=PIXI.ObservablePoint,O=(t(E,R=T),Object.defineProperty(E.prototype,"anchor",{get:function(){return this._anchor},set:function(t){this._anchor.copyFrom(t)},enumerable:!0,configurable:!0}),Object.defineProperty(E.prototype,"anchorOffset",{get:function(){var t=this.shapeWidth,e=this.shapeHeight,i=this._anchor;return{x:-t*i.x,y:-e*i.y}},enumerable:!0,configurable:!0}),E.prototype._onAnchorUpdate=function(){this.$onModify()},E.prototype.$onModify=function(t,e){this.__fieldDirty=!0,this._t&&(clearTimeout(this._t),this._t=null),this._t=setTimeout(this.nextTick)},E.prototype.drawDirectionLine=function(){var t=this.pivot,e=t.x,i=t.y,r=this.directionLineWidth;this.lineStyle(r,16777215-this.fillColor),this.moveTo(e,i),this.lineTo(e+this.shapeWidth/2,i)},e([s.dirtyFieldTrigger],E.prototype,"fillColor",void 0),e([s.dirtyFieldTrigger],E.prototype,"fillAlpha",void 0),e([s.dirtyFieldTrigger],E.prototype,"strokeColor",void 0),e([s.dirtyFieldTrigger],E.prototype,"strokeAlpha",void 0),e([s.dirtyFieldTrigger],E.prototype,"strokeWidth",void 0),e([s.dirtyFieldTrigger],E.prototype,"strokeAlignment",void 0),e([s.dirtyFieldTrigger],E.prototype,"shapeWidth",void 0),e([s.dirtyFieldTrigger],E.prototype,"shapeHeight",void 0),e([s.dirtyFieldTrigger],E.prototype,"directionLineWidth",void 0),E);function E(){var a=R.call(this)||this;return a.__fieldDirty=!0,a.fillColor="0xffffff",a.fillAlpha=1,a.strokeColor=0,a.strokeAlpha=1,a.strokeWidth=0,a.strokeAlignment=.5,a.shapeWidth=0,a.shapeHeight=0,a.directionLineWidth=0,a._anchor=new _(a._onAnchorUpdate,a),a.nextTick=function(){if(a.__fieldDirty){a.__fieldDirty=!1;var t=a.fillColor,e=a.fillAlpha,i=a.strokeColor,r=a.strokeWidth,o=a.strokeAlpha,n=a.strokeAlignment;a.clear(),a.beginFill(t,e),0<r&&a.lineStyle(r,i,o,n),a.redraw(),a.endFill(),0<a.directionLineWidth&&a.drawDirectionLine()}},a._anchor=new _(a._onAnchorUpdate,a),a}var S,A=(t(m,S=O),m.prototype.redraw=function(){var t=this.shapeWidth,e=this.shapeHeight,i=this.borderRadius,r=this.anchorOffset,o=r.x,n=r.y;0<i?this.drawRoundedRect(o,n,t,e,i):this.drawRect(o,n,t,e)},e([s.dirtyFieldTrigger],m.prototype,"borderRadius",void 0),m);function m(){var t=null!==S&&S.apply(this,arguments)||this;return t.borderRadius=0,t}var I,D=(t(C,I=O),C.prototype.redraw=function(){var t=this.shapeWidth,e=this.shapeHeight,i=this.anchorOffset,r=i.x,o=i.y,n=Math.min(t,e)/2;this.drawCircle(n-r,n-o,n)},C);function C(){return null!==I&&I.apply(this,arguments)||this}var w,N=(t(L,w=O),L.prototype.redraw=function(){var t=this.shapeWidth,e=this.shapeHeight,i=this.anchorOffset,r=i.x,o=i.y,n=Math.min(t,e)/2,a=this.points,s=this.innerRadius,p=this.starRotation,d=[n-r,n-o,a,n];void 0!==s?d.push(s):void 0!==p&&d.push(void 0,p),this.drawStar.apply(this,d)},e([s.dirtyFieldTrigger],L.prototype,"points",void 0),e([s.dirtyFieldTrigger],L.prototype,"innerRadius",void 0),e([s.dirtyFieldTrigger],L.prototype,"starRotation",void 0),L);function L(){var t=null!==w&&w.apply(this,arguments)||this;return t.points=5,t.starRotation=0,t}var P,F=(t(x,P=O),x.prototype.redraw=function(){var t=this.shapeWidth,e=this.shapeHeight,i=this.anchorOffset,r=(i.x,i.y,Math.min(t,e)/2),o=this.points,n=this.innerRadius,a=this.starRotation;void 0===n&&(n=r/2);for(var s=2*Math.PI/o,p=Math.cos(a)*r+r,d=Math.sin(a)*r+r,h=0;h<o;h++){0===h&&this.moveTo(p,d);var l=a+s*(h+.5),u=Math.cos(l)*n+r,c=Math.sin(l)*n+r,f=a+s*(h+1);p=Math.cos(f)*r+r,d=Math.sin(f)*r+r,this.quadraticCurveTo(u,c,p,d)}this.closePath()},e([s.dirtyFieldTrigger],x.prototype,"points",void 0),e([s.dirtyFieldTrigger],x.prototype,"innerRadius",void 0),e([s.dirtyFieldTrigger],x.prototype,"starRotation",void 0),x);function x(){var t=null!==P&&P.apply(this,arguments)||this;return t.points=5,t.starRotation=0,t}var M,H={align:["string",""],breakWords:["boolean",""],dropShadow:["boolean",""],dropShadowAlpha:["number",""],dropShadowAngle:["number",""],dropShadowBlur:["number",""],dropShadowColor:["color",""],dropShadowDistance:["number",""],fill:["color",""],fontFamily:["string",""],fontSize:["number",""],fontStyle:["string",""],fontVariant:["string",""],fontWeight:["string",""],leading:["number",""],letterSpacing:["number",""],lineHeight:["number",""],lineJoin:["string",""],miterLimit:["number",""],padding:["number",""],stroke:["number",""],strokeThickness:["number",""],trim:["boolean",""],textBaseline:["string",""],whiteSpace:["string",""],wordWrap:["boolean",""],wordWrapWidth:["number",""]};(M=n.PIXI_BLEND_MODES||(n.PIXI_BLEND_MODES={}))[M.NORMAL=0]="NORMAL",M[M.ADD=1]="ADD",M[M.MULTIPLY=2]="MULTIPLY",M[M.SCREEN=3]="SCREEN",M[M.OVERLAY=4]="OVERLAY",M[M.DARKEN=5]="DARKEN",M[M.LIGHTEN=6]="LIGHTEN",M[M.COLOR_DODGE=7]="COLOR_DODGE",M[M.COLOR_BURN=8]="COLOR_BURN",M[M.HARD_LIGHT=9]="HARD_LIGHT",M[M.SOFT_LIGHT=10]="SOFT_LIGHT",M[M.DIFFERENCE=11]="DIFFERENCE",M[M.EXCLUSION=12]="EXCLUSION",M[M.HUE=13]="HUE",M[M.SATURATION=14]="SATURATION",M[M.COLOR=15]="COLOR",M[M.LUMINOSITY=16]="LUMINOSITY",M[M.NORMAL_NPM=17]="NORMAL_NPM",M[M.ADD_NPM=18]="ADD_NPM",M[M.SCREEN_NPM=19]="SCREEN_NPM",M[M.NONE=20]="NONE",M[M.SRC_OVER=0]="SRC_OVER",M[M.SRC_IN=21]="SRC_IN",M[M.SRC_OUT=22]="SRC_OUT",M[M.SRC_ATOP=23]="SRC_ATOP",M[M.DST_OVER=24]="DST_OVER",M[M.DST_IN=25]="DST_IN",M[M.DST_OUT=26]="DST_OUT",M[M.DST_ATOP=27]="DST_ATOP",M[M.ERASE=26]="ERASE",M[M.SUBTRACT=28]="SUBTRACT",M[M.XOR=29]="XOR";var W,k,U={Node:{def:a.Container,isContainer:!0,props:{position:["vector2",[0,0]],scale:["vector2",[1,1]],anchor:["vector2",[0,0]],pivot:["vector2",[0,0]],skew:["vector2",[0,0]],width:["number",0],height:["number",0],alpha:["number",0],angle:["number",0],buttonMode:["boolean",!0],interactive:["boolean",!0],interactiveChildren:["boolean",!0],zIndex:["number",0]}},Sprite:{base:"Node",def:a.Sprite,isContainer:!0,props:{blendMode:["enum","NORMAL",n.PIXI_BLEND_MODES],tint:["color",16777215],texture:["texture"]}},Text:{base:"Sprite",def:a.Text,isContainer:!0,props:{text:["string"],style:["object",null,H]}},Graphics:{base:"Node",def:a.Graphics,isContainer:!0,props:{tint:["color",16777215]}},ShapeBase:{base:"Graphics",def:O,isContainer:!0,hidden:!0,props:{fillColor:["color",16777215],strokeColor:["color",0],strokeWidth:["number",0]}},Rect:{base:"ShapeBase",def:A,isContainer:!0,props:{borderRadius:["number",0]}},Circle:{base:"ShapeBase",def:D,isContainer:!0,props:{}},Star:{base:"ShapeBase",def:N,isContainer:!0,props:{points:["number",5],innerRadius:["number"],starRotation:["number",0]}},StarBezier:{base:"ShapeBase",def:F,isContainer:!0,props:{points:["number",5],innerRadius:["number"],starRotation:["number",0]}}},X="WebGL";a.utils.isWebGLSupported()||(X="canvas"),a.utils.sayHello(X),(k=n.Resolution||(n.Resolution={}))[k.WIDTH_FIXED=0]="WIDTH_FIXED",k[k.HEIGHT_FIXED=1]="HEIGHT_FIXED";var j={resolution:n.Resolution.WIDTH_FIXED,designWidth:750,designHeight:1334,antialias:!0,autoResize:!0};var G,B=(t(z,G=s.Component),Object.defineProperty(z.prototype,"entity",{get:function(){return this.entityAdaptor?this.entityAdaptor.entity:null},enumerable:!0,configurable:!0}),z);function z(){return null!==G&&G.apply(this,arguments)||this}n.Component=B,n.PIXI_TextStyle=H,n.bubbling=d,n.createApp=function(t){var e={};s.injectProp(e,j),s.injectProp(e,t),(W=new s.Application).registerEntityDefs(U);var i=new a.Application({antialias:e.antialias}),r=i.renderer.view;r.style.position="absolute",r.style.display="block",r.style.width="100%",r.style.height="100%",function(r,o){o.autoResize&&(window.onresize=t);function t(){var t,e=o.designWidth,i=o.designHeight;switch(o.resolution){case n.Resolution.WIDTH_FIXED:t=window.innerWidth/e,i=window.innerHeight/t;break;case n.Resolution.HEIGHT_FIXED:t=window.innerHeight/i,e=window.innerWidth/t}r.renderer.resize(e,i)}t()}(i,e),document.body.appendChild(i.view);var o=W.setupAdaptor({stage:i.stage,EntityAdaptor:l,addDisplayFunc:function(t,e){e.addChild(t)},traverseFunc:p,bubblingFunc:d,loadAssetFunc:g,protocols:b,context:{pixiApp:i}});return a.Ticker.shared.add(function(t){o(1e3*t/60)}),W},n.createEntity=function(t){return W.createEntity(t)},n.entityProps=U,n.traverse=p,Object.defineProperty(n,"__esModule",{value:!0})});
